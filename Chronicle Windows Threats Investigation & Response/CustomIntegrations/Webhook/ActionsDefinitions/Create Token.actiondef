{"Name":"Create Token","Description":"Creates token for a new webhook.","Script":"from WebhookManager import WebhookManager\nfrom SiemplifyAction import SiemplifyAction\nfrom SiemplifyUtils import output_handler\nfrom ScriptResult import EXECUTION_STATE_COMPLETED, EXECUTION_STATE_FAILED,EXECUTION_STATE_TIMEDOUT\n\n# Consts:\nINTEGRATION_NAME = \"Webhook\"\nSCRIPT_NAME = \"Create Token\"\n\n@output_handler\ndef main():\n    siemplify = SiemplifyAction()\n    siemplify.script_name = SCRIPT_NAME\n    siemplify.LOGGER.info(\"================= Main - Param Init =================\")\n\n    conf = siemplify.get_configuration(INTEGRATION_NAME)\n    baseUrl = conf.get(\"URL\")\n    \n    # INIT ACTION PARAMETERS:\n    def_content = siemplify.extract_action_param(param_name=\"Default Content\")\n    def_content_type = siemplify.extract_action_param(param_name=\"Default Content Type\").strip()\n    timeout = siemplify.extract_action_param(param_name=\"Timeout\")\n\n    siemplify.LOGGER.info(\"================= Main - Started ====================\")\n    \n    # Init result json:\n    res_json = {}\n    # Init result values:\n    status = EXECUTION_STATE_FAILED\n    output_message = \"Something went wrong. \" \n    result_value = False\n\n    # Create manager instance for methods:\n    webhookManager = WebhookManager(baseUrl)\n\n    try:\n        # Create token:\n        res_json = webhookManager.create_token(def_content ,def_content_type ,timeout)\n        res_json[\"webhookURL\"] = f'{baseUrl}/{res_json.get(\"uuid\")}'\n        status = EXECUTION_STATE_COMPLETED\n        output_message = f'URL Created: {res_json.get(\"webhookURL\")}'\n        result_value = True\n        \n    except Exception as e:\n        siemplify.LOGGER.error(e)\n        output_message += \"Error: \" + str(e)\n    \n    finally:\n        siemplify.LOGGER.info(\"\\n  status: {}\\n  result_value: {}\\n  output_message: {}\".format(status,result_value, output_message))\n        siemplify.result.add_result_json(res_json)\n        siemplify.end(output_message, result_value, status)\n\n\nif __name__ == \"__main__\":\n    main()\n","IntegrationIdentifier":"Webhook","ScriptResultName":"ScriptResult","DynamicResultsMetadata":[{"ResultName":"JsonResult","ResultExample":"{\r\n\t\"uuid\": \"7fc8d86a-280a-4308-9cb4-48a8070cfe81\",\r\n\t\"redirect\": false,\r\n\t\"alias\": null,\r\n\t\"actions\": true,\r\n\t\"cors\": false,\r\n\t\"expiry\": true,\r\n\t\"timeout\": 0,\r\n\t\"premium\": false,\r\n\t\"user_id\": null,\r\n\t\"password\": false,\r\n\t\"ip\": \"54.91.20.83\",\r\n\t\"user_agent\": \"python-requests/2.26.0\",\r\n\t\"default_content\": \"On the hook\",\r\n\t\"default_status\": 200,\r\n\t\"default_content_type\": \"text/html\",\r\n\t\"premium_expires_at\": null,\r\n\t\"created_at\": \"2021-08-23 14:34:53\",\r\n\t\"updated_at\": \"2021-08-23 14:34:53\",\r\n\t\"webhookURL\": \"https://webhook.site/7fc8d86a-280a-4308-9cb4-48a8070cfe81\"\r\n}","ShowResult":true}],"Creator":"shakedalontest","IsEnabled":true,"IsCustom":true,"IsSystem":false,"Version":47.0,"TimeoutSeconds":300,"IsAsync":null,"AsyncPollingIntervalInSeconds":3600,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"Hello world","Description":"Content to be presented upon the webhook URL click, if successful.","Name":"Default Content","Value":"Hello world","Type":0,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"text/html","Description":"Type of content to be presented upon the new webhook URL click","Name":"Default Content Type","Value":"text/html","Type":0,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":false,"DefaultValue":"0","Description":"Amount of seconds to wait before returning the response (intended for testing timeouts). \nMax is 10.","Name":"Timeout","Value":"0","Type":0,"OptionalValues":null,"OptionalValuesJson":null}],"DefaultResultValue":"","PythonVersion":"None","SimulationData":{"Entities":null},"SimulationDataJson":null}